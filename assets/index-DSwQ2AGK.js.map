{"version":3,"file":"index-DSwQ2AGK.js","sources":["../../src/utils/fullscreen.js","../../src/config.js","../../src/app.js","../../src/objects/player/abilities/attach.js","../../src/objects/player/abilities/dash.js","../../src/objects/rope.js","../../src/objects/player/abilities/hook.js","../../src/objects/player/particles.js","../../src/objects/player/player.js","../../src/scenes/testing_scene.js","../../src/main.js"],"sourcesContent":["function resizeGame(kaplay) {\r\n  const gameCanvas = document.querySelector(\"canvas\");\r\n\r\n  const winWidth = window.innerWidth;\r\n  const winHeight = window.innerHeight;\r\n\r\n  const scaleX = Math.floor(winWidth / kaplay.width);\r\n  const scaleY = Math.floor(winHeight / kaplay.height);\r\n  const scale = Math.max(1, Math.min(scaleX, scaleY));\r\n\r\n  gameCanvas.style.width = kaplay.width * scale + \"px\";\r\n  gameCanvas.style.height = kaplay.height * scale + \"px\";\r\n  gameCanvas.style.imageRendering = \"pixelated\";\r\n  gameCanvas.style.position = \"absolute\";\r\n  gameCanvas.style.top = \"50%\";\r\n  gameCanvas.style.left = \"50%\";\r\n  gameCanvas.style.transform = \"translate(-50%, -50%)\";\r\n}\r\n\r\nfunction goFullscreen() {\r\n  const canvas = document.querySelector(\"canvas\");\r\n  if (canvas.requestFullscreen) {\r\n    canvas.requestFullscreen();\r\n  } else if (canvas.webkitRequestFullscreen) {\r\n    canvas.webkitRequestFullscreen();\r\n  }\r\n}\r\n\r\nexport function fullscreenHandler(kaplay) {\r\n  window.addEventListener(\"resize\", resizeGame(kaplay));\r\n  window.addEventListener(\"load\", resizeGame(kaplay));\r\n\r\n  document.addEventListener(\"keydown\", (e) => {\r\n    if (e.key === \"f\") {\r\n      goFullscreen();\r\n    }\r\n  });\r\n}\r\n","export const GAME_WIDTH = 800;\r\nexport const GAME_HEIGHT = 450;\r\n\r\n// 16:9\r\n\r\nexport const COLORS = {\r\n  background: [39, 38, 36],\r\n  foreground: [255, 255, 255],\r\n};\r\n","const App = {\r\n  kaplayInstance: null,\r\n  currentScene: null,\r\n\r\n  init(kaplayInstance) {\r\n    this.kaplayInstance = kaplayInstance;\r\n  },\r\n\r\n  addScene(name, sceneFunc) {\r\n    if (!this.kaplayInstance) {\r\n      console.error(\"Kaplay instance не инициализирован\");\r\n      return;\r\n    }\r\n\r\n    this.kaplayInstance.scene(name, sceneFunc);\r\n  },\r\n\r\n  startScene(name) {\r\n    if (!this.kaplayInstance) {\r\n      console.error(\"Kaplay instance не инициализирован\");\r\n      return;\r\n    }\r\n\r\n    this.currentScene = name;\r\n    this.kaplayInstance.go(name);\r\n  },\r\n};\r\n\r\nexport default App;\r\n","export function initAttachAbility(player, jumpForce) {\r\n  const ATTACH_DISTANCE = 32;\r\n  let hasAttached = false;\r\n  let isAttached = false;\r\n  let attachedPos = null;\r\n\r\n  const getAttachPoint = () => {\r\n    let direction = vec2(player.lastDirection, 0);\r\n\r\n    const hit = raycast(player.pos, direction.scale(ATTACH_DISTANCE), [\r\n      \"player\",\r\n    ]);\r\n\r\n    // DEBUG HERE, idgaf, i dont wanna make it clear, soooo some comments here hehehe\r\n    // const draw = () => {\r\n    //   const endPos = player.pos.add(direction.scale(ATTACH_DISTANCE));\r\n\r\n    //   drawLine({\r\n    //     p1: player.pos,\r\n    //     p2: endPos,\r\n    //     width: 2,\r\n    //     color: BLUE,\r\n    //   });\r\n    // };\r\n\r\n    // onDraw(() => {\r\n    //   draw();\r\n    // });\r\n\r\n    if (hit) {\r\n      return hit.point;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const attachToWall = (point) => {\r\n    isAttached = true;\r\n    hasAttached = true;\r\n    attachedPos = point.clone();\r\n\r\n    player.vel = vec2(0, 0);\r\n    player.gravity = 0;\r\n    shake(5);\r\n  };\r\n\r\n  const disattachWall = () => {\r\n    if (isAttached) {\r\n      isAttached = false;\r\n      attachedPos = null;\r\n      player.gravity = 1;\r\n\r\n      shake(1);\r\n      player.vel = vec2(player.vel.x, -5);\r\n    }\r\n  };\r\n\r\n  onKeyPress(\"down\", () => {\r\n    disattachWall();\r\n  });\r\n\r\n  onKeyPress(\"up\", () => {\r\n    if (isAttached) {\r\n      disattachWall();\r\n      player.applyImpulse(vec2(0, jumpForce));\r\n    }\r\n  });\r\n\r\n  player.onUpdate(() => {\r\n    if (player.isGrounded()) {\r\n      hasAttached = false;\r\n    }\r\n\r\n    if (isAttached && attachedPos) {\r\n      player.pos = attachedPos.clone();\r\n      player.vel = vec2(0, 0);\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !isAttached &&\r\n      !hasAttached &&\r\n      !player.isGrounded() &&\r\n      Math.abs(player.vel.x) > 2\r\n    ) {\r\n      const point = getAttachPoint();\r\n      if (point) {\r\n        attachToWall(point);\r\n      }\r\n    }\r\n  });\r\n}\r\n","const IMPULSE_FORCE = 500;\r\n\r\nexport function initDashAbility(player) {\r\n  let hasDashed = false;\r\n\r\n  const useDash = () => {\r\n    if (hasDashed == true) return;\r\n\r\n    hasDashed = true;\r\n    player.applyImpulse(vec2(IMPULSE_FORCE * player.lastDirection, 0));\r\n  };\r\n\r\n  player.onUpdate(() => {\r\n    if (player.isGrounded()) {\r\n      hasDashed = false;\r\n    }\r\n  });\r\n\r\n  onKeyPress(\"x\", () => {\r\n    useDash(player);\r\n  });\r\n\r\n  return {\r\n    hasDashed,\r\n    useDash,\r\n  };\r\n}\r\n","export function createSwingRope(anchor, radius) {\r\n  let angle = Math.PI / 2; // 90° вниз\r\n  let angularVelocity = 0;\r\n  const gravity = 0.5; // сила притяжения (можно тюнить)\r\n  const damping = 0.995; // трение\r\n\r\n  let player = null;\r\n\r\n  function attach(entity) {\r\n    player = entity;\r\n    const dx = player.pos.x - anchor.x;\r\n    const dy = player.pos.y - anchor.y;\r\n    angle = Math.atan2(dy, dx);\r\n    angularVelocity = 0;\r\n  }\r\n\r\n  function applyImpulse(force) {\r\n    angularVelocity += force;\r\n  }\r\n\r\n  function update(dt) {\r\n    if (!player) return;\r\n\r\n    const frameFactor = dt() * 60;\r\n\r\n    angularVelocity += gravity * Math.cos(angle) * frameFactor;\r\n    angularVelocity *= Math.pow(damping, frameFactor);\r\n    angle += angularVelocity * frameFactor;\r\n\r\n    const dx = player.pos.x - anchor.x;\r\n    const dy = player.pos.y - anchor.y;\r\n    const dist = Math.sqrt(dx * dx + dy * dy);\r\n\r\n    if (dist !== radius) {\r\n      const nx = dx / dist;\r\n      const ny = dy / dist;\r\n\r\n      player.pos.x = anchor.x + nx * radius;\r\n      player.pos.y = anchor.y + ny * radius;\r\n\r\n      const radialVel = player.vel.x * nx + player.vel.y * ny;\r\n      player.vel.x -= radialVel * nx;\r\n      player.vel.y -= radialVel * ny;\r\n    }\r\n  }\r\n\r\n  function drawRope() {\r\n    if (!player) return;\r\n\r\n    drawLine({\r\n      p1: anchor,\r\n      p2: player.pos,\r\n      width: 2,\r\n      color: [0, 0, 0],\r\n    });\r\n  }\r\n\r\n  function setAnchor(newAnchor) {\r\n    anchor = newAnchor;\r\n    if (player) {\r\n      const dx = player.pos.x - anchor.x;\r\n      const dy = player.pos.y - anchor.y;\r\n      angle = Math.atan2(dy, dx);\r\n      angularVelocity = 0;\r\n    }\r\n  }\r\n\r\n  function setRadius(newRadius) {\r\n    radius = newRadius;\r\n    if (player) {\r\n      const dx = player.pos.x - anchor.x;\r\n      const dy = player.pos.y - anchor.y;\r\n      angle = Math.atan2(dy, dx);\r\n\r\n      player.pos.x = anchor.x + Math.cos(angle) * radius;\r\n      player.pos.y = anchor.y + Math.sin(angle) * radius;\r\n\r\n      const nx = Math.cos(angle);\r\n      const ny = Math.sin(angle);\r\n      const radialVel = player.vel.x * nx + player.vel.y * ny;\r\n      player.vel.x -= radialVel * nx;\r\n      player.vel.y -= radialVel * ny;\r\n    }\r\n  }\r\n\r\n  return {\r\n    attach,\r\n    applyImpulse,\r\n    update,\r\n    setAnchor,\r\n    setRadius,\r\n    draw: drawRope,\r\n  };\r\n}\r\n","import { createSwingRope } from \"../../rope\";\r\n\r\nconst HOOK_IMPULSE = 400;\r\nconst HOOK_LEN = 120;\r\n\r\nexport function initHookAbility(player) {\r\n  const rope = createSwingRope(vec2(0, 0), HOOK_LEN);\r\n  let updateRope = false;\r\n\r\n  rope.attach(player);\r\n\r\n  onKeyPress(\"z\", () => {\r\n    // if rope is not active, release new rope\r\n    if (updateRope == false) {\r\n      let isSuccess = releaseHook(player, rope);\r\n      isSuccess ? (updateRope = true) : null;\r\n      return;\r\n    }\r\n\r\n    // otherwise, remove the hook and set false updateRope flag\r\n    updateRope = false;\r\n    removeHook(player);\r\n  });\r\n\r\n  onKeyPress(\"down\", () => {\r\n    if (updateRope == true) updateRope = false;\r\n  });\r\n\r\n  onUpdate(() => {\r\n    if (updateRope) {\r\n      rope.update(dt);\r\n    }\r\n  });\r\n\r\n  onDraw(() => {\r\n    if (updateRope) {\r\n      rope.draw();\r\n    }\r\n  });\r\n\r\n  const isHooked = () => {\r\n    return updateRope;\r\n  };\r\n\r\n  return {\r\n    isHooked: isHooked,\r\n  };\r\n}\r\n\r\nconst releaseHook = (player, rope) => {\r\n  const hit = getNewHookPoint(player);\r\n  if (hit == null) {\r\n    return false;\r\n  }\r\n\r\n  rope.setAnchor(hit);\r\n\r\n  const hook_len = hit.sub(player.pos).len();\r\n  if (hook_len < HOOK_LEN) {\r\n    rope.setRadius(hook_len);\r\n  } else {\r\n    rope.setRadius(HOOK_LEN);\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nconst removeHook = (player) => {\r\n  let newDir = Vec2.fromAngle(-45).scale(HOOK_IMPULSE);\r\n  newDir.x = newDir.x * player.lastDirection;\r\n  player.applyImpulse(newDir);\r\n};\r\n\r\nconst getNewHookPoint = (player) => {\r\n  let direction = Vec2.fromAngle(-45);\r\n  player.lastDirection > 0\r\n    ? (direction.x = direction.x)\r\n    : (direction.x = -direction.x);\r\n  let hit = raycast(player.pos, direction.scale(HOOK_LEN), [\"player\"]);\r\n\r\n  if (hit) {\r\n    return hit.point;\r\n  }\r\n\r\n  return null;\r\n};\r\n","export function createFootstepEmitter(player) {\r\n  const dustSprite = getSprite(\"dust\");\r\n  const dustTexture = dustSprite.data.tex;\r\n  const dustFrame = dustSprite.data.frames[0];\r\n\r\n  const emitter = add([\r\n    pos(),\r\n    particles(\r\n      {\r\n        max: 50,\r\n        lifeTime: [0.5, 5],\r\n        speed: [10, 5],\r\n        texture: dustTexture,\r\n        quads: [dustFrame],\r\n      },\r\n      {\r\n        direction: 90,\r\n        spread: 20,\r\n      }\r\n    ),\r\n  ]);\r\n\r\n  return emitter;\r\n}\r\n","import { initAttachAbility } from \"./abilities/attach\";\r\nimport { initDashAbility } from \"./abilities/dash\";\r\nimport { initHookAbility } from \"./abilities/hook\";\r\nimport { createFootstepEmitter } from \"./particles\";\r\n\r\nconst JUMP_FORCE = -600;\r\nconst SPEED = 200;\r\nconst DRAG_ON_GROUND = 7;\r\n\r\nexport const spawnPlayer = (position) => {\r\n  loadSprite(\"hero\", \"./sprites/all.png\", {\r\n    sliceX: 8,\r\n    sliceY: 2,\r\n    anims: {\r\n      afk: 0,\r\n      idle: { from: 0, to: 7, loop: true },\r\n      walk: { from: 8, to: 14, loop: true },\r\n    },\r\n  });\r\n\r\n  const player = add([\r\n    sprite(\"hero\"),\r\n    pos(position),\r\n    area(),\r\n    body(),\r\n    anchor(\"center\"),\r\n    color(0, 0, 0),\r\n    \"player\",\r\n  ]);\r\n\r\n  // Player variables\r\n  player.lastDirection = 1;\r\n\r\n  // Abilities\r\n  const dashAbility = initDashAbility(player);\r\n  const attachAbility = initAttachAbility(player, JUMP_FORCE);\r\n  const hookAbility = initHookAbility(player);\r\n\r\n  // Player movement\r\n  onKeyDown(\"left\", () => {\r\n    player.flipX = true;\r\n    player.move(-SPEED, 0);\r\n    player.lastDirection = -1;\r\n  });\r\n\r\n  onKeyDown(\"right\", () => {\r\n    player.flipX = false;\r\n    player.move(SPEED, 0);\r\n    player.lastDirection = 1;\r\n  });\r\n\r\n  onKeyPress(\"up\", () => {\r\n    if (player.isGrounded()) {\r\n      player.applyImpulse(vec2(0, JUMP_FORCE));\r\n    }\r\n  });\r\n\r\n  // Physics\r\n  player.onUpdate(() => {\r\n    if (player.isGrounded()) {\r\n      player.drag = DRAG_ON_GROUND;\r\n    } else {\r\n      player.drag = 0;\r\n    }\r\n\r\n    if (player.isGrounded()) {\r\n      if (isKeyDown(\"left\") || isKeyDown(\"right\")) {\r\n        if (player.curAnim() == \"walk\") return;\r\n\r\n        player.play(\"walk\");\r\n      } else {\r\n        if (player.curAnim() == \"idle\") return;\r\n\r\n        player.play(\"idle\");\r\n      }\r\n    } else {\r\n      player.play(\"afk\");\r\n    }\r\n  });\r\n\r\n  // Particlies\r\n  loadSprite(\"dust\", \"./sprites/dust.png\").then(() => {\r\n    const footsteps = createFootstepEmitter(player);\r\n  });\r\n\r\n  return player;\r\n};\r\n","import { spawnPlayer } from \"../objects/player/player\";\r\n\r\nexport const test_scene = () => {\r\n  let player = spawnPlayer(vec2(width() / 6 + 50, height() - 200));\r\n\r\n  add([\r\n    rect(width() / 3, 20),\r\n    pos(0, height() - 20),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(width() / 3, 20),\r\n    pos((width() / 3) * 2, height() - 20),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(width() / 3, 20),\r\n    pos(width() / 6, height() - 200),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(20, height() - 20),\r\n    pos(width() - 20, 0),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(20, height() - 20),\r\n    pos(0, 0),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(20, height() - 20),\r\n    pos(width() / 2, height() * -0.355),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  add([\r\n    rect(20, height() - 20),\r\n    pos(width() * 0.66, height() * 0.75),\r\n    area(),\r\n    body({ isStatic: true }),\r\n    color(0, 0, 0),\r\n    \"solid\",\r\n  ]);\r\n\r\n  setGravity(1600);\r\n};\r\n","import kaplay from \"kaplay\";\nimport { fullscreenHandler } from \"./utils/fullscreen\";\nimport { GAME_WIDTH, GAME_HEIGHT } from \"./config.js\";\n\nimport App from \"./app.js\";\nimport { test_scene } from \"./scenes/testing_scene.js\";\n\nconst k = kaplay({\n  background: [255, 255, 255],\n  width: GAME_WIDTH,\n  height: GAME_HEIGHT,\n  scale: 1,\n  pixelated: true,\n});\n\nfullscreenHandler(k);\n\nApp.init(k);\n\nApp.addScene(\"test\", test_scene);\nApp.startScene(\"test\");\n"],"names":["resizeGame","kaplay","gameCanvas","winWidth","winHeight","scaleX","scaleY","scale","goFullscreen","canvas","fullscreenHandler","GAME_WIDTH","GAME_HEIGHT","App","kaplayInstance","name","sceneFunc","initAttachAbility","player","jumpForce","hasAttached","isAttached","attachedPos","getAttachPoint","direction","hit","attachToWall","point","disattachWall","IMPULSE_FORCE","initDashAbility","hasDashed","useDash","createSwingRope","anchor","radius","angle","angularVelocity","gravity","damping","attach","entity","dx","dy","applyImpulse","force","update","dt","frameFactor","dist","nx","ny","radialVel","drawRope","setAnchor","newAnchor","setRadius","newRadius","HOOK_IMPULSE","HOOK_LEN","initHookAbility","rope","updateRope","releaseHook","removeHook","getNewHookPoint","hook_len","newDir","createFootstepEmitter","dustSprite","dustTexture","dustFrame","JUMP_FORCE","SPEED","DRAG_ON_GROUND","spawnPlayer","position","test_scene","k"],"mappings":"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"}